import requests
import json

API_KEY = 'YOUR_API_KEY'

def scan_file(file_path):
    url = 'https://www.virustotal.com/vtapi/v2/file/scan'
    params = {'apikey': API_KEY}
    files = {'file': (file_path, open(file_path, 'rb'))}

    response = requests.post(url, files=files, params=params)
    if response.status_code == 200:
        print('File submitted for scanning')
        resource = json.loads(response.text)['resource']
        return resource
    else:
        print('Error submitting file for scanning')
        return None

def get_report(resource):
    url = 'https://www.virustotal.com/vtapi/v2/file/report'
    params = {'apikey': API_KEY, 'resource': resource}

    response = requests.get(url, params=params)
    if response.status_code == 200:
        report = json.loads(response.text)
        positives = report['positives']
        total = report['total']
        scans = report['scans']
        print(f'{positives} out of {total} antivirus scanners detected malware')
        for scanner, result in scans.items():
            print(f'{scanner}: {result["result"]}')
    else:
        print('Error retrieving report')
        
file_path = 'PATH_TO_FILE'
resource = scan_file(file_path)
if resource:
    get_report(resource)
